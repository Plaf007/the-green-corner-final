<div class="container">
  <%= link_to "Regresar a productos", products_path, class: "btn btn-outline-secondary btn-sm" %>
</div>

<div class="container mt-4">
  <div class="row d-flex justify-content-center mt-3 rounded-2">
    <h1 class="h1-cart text-center" style="text-shadow: 1px 1px 1px #000000;">Order</h1>
  </div>

  <div class="container mt-4">
    <h4 class="product-list-title">Orden</h4>
    <p class="order-status">Estado: <%= display_order_status(@order.status) %></p>
    <p class="order-number">Número de Orden: <%= @order.id %></p>
  </div>

  <div class="container mt-3">
    <% @order.selected_products.each do |selected_product| %>
      <div class="card mb-3 card-hover shadow p-3 mb-5">
        <div class="row g-0">
          <div class="col-md-4 r">
            <% if selected_product.product.photo.attached? %>
              <%= image_tag selected_product.product.photo, class: 'product-image', height: 200, width: 300, crop: :fill  %>
            <% else %>
              <p>No image available</p>
            <% end %>
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title"><%= selected_product.product.title %></h5>
              <p class="product-description"><%= selected_product.product.description %></p>
              <p class="card-text">
                <small class="text-muted">Número de serie: <%= selected_product.product.id %></small>
              </p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <label class="text-muted">Precio:</label>
                  <span class="text-muted"><%= number_to_currency(selected_product.price) %></span>
                </div>
                <div>
                  <label class="text-muted">Total:</label>
                  <span class="text-muted"><%= number_to_currency(selected_product.calculate_total_due([selected_product])) %></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="d-flex justify-content-end">
    <div class="text-end">
      <h3 class="product-total-title">Total: <%= number_to_currency(@total_due) %></h3>
      <%= link_to "Ir a todas mis órdenes", orders_path, class: "btn btn-primary btn-sm btn-custom" %>
    </div>
  </div>
</div>
